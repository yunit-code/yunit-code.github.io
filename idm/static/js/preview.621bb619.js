(window["idmcore_webpackJsonp"]=window["idmcore_webpackJsonp"]||[]).push([["preview"],{"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("d3b7");function n(e,t,a,n,i,o,r){try{var d=e[o](r),s=d.value}catch(c){return void a(c)}d.done?t(s):Promise.resolve(s).then(n,i)}function i(e){return function(){var t=this,a=arguments;return new Promise((function(i,o){var r=e.apply(t,a);function d(e){n(r,i,o,d,s,"next",e)}function s(e){n(r,i,o,d,s,"throw",e)}d(void 0)}))}}},"5b0b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"idm_render_engine_container"},[a("transition-group",{staticClass:"idm_render_engine_router_container",attrs:{tag:"div",name:"slide-fade"},on:{"after-enter":e.transitionAfterEnter}},[e._l(e.AppPageList,(function(t,n){return[t.keep?a("Page",{key:n,ref:"idm_page_"+t.routerId,refInFor:!0,tag:"component",attrs:{pageid:t.pageid,routerId:t.routerId,devpreview:t.devpreview,mainPage:t.mainPage,index:n},on:{mainPageSettingHandle:e.mainPageSettingHandle}}):e._e()]}))],2),a("idm-a-drawer",{attrs:{title:e.pagePropData.drawerTitleShow?e.pagePropData.drawerTitle:"",placement:e.pagePropData.drawerPlacement||"right",closable:!1!==e.pagePropData.drawerClosable,destroyOnClose:e.pagePropData.drawerDestroyOnClose,maskClosable:!1!==e.pagePropData.drawerMaskClosable,mask:!1!==e.pagePropData.drawerMask,keyboard:!1!==e.pagePropData.drawerKeyboarde,maskStyle:e.commonCustomEventFunHandle(e.pagePropData,"drawerMaskStyleFunction")||{},wrapStyle:e.commonCustomEventFunHandle(e.pagePropData,"drawerWrapStyleFunction")||{},drawerStyle:e.commonCustomEventFunHandle(e.pagePropData,"drawerStyleFunction")||{},headerStyle:e.commonCustomEventFunHandle(e.pagePropData,"drawerHeaderStyleFunction")||{},bodyStyle:e.commonCustomEventFunHandle(e.pagePropData,"drawerBodyStyleFunction")||{},width:e.pagePropData.drawerWidth||256,height:e.pagePropData.drawerHeight||256,zIndex:e.pagePropData.drawerZIndex||1e3,wrapClassName:(e.pagePropData.drawerWrapClassName||"")+" idm_module_setting_drawer",visible:e.drawerVisible},on:{close:e.drawerOnClose,afterVisibleChange:e.drawerOnAfterVisibleChange}},[a("iframe",{staticClass:"idm_drawer_iframe_basestyle",attrs:{src:e.drawerIframeUrl,name:"idm_drawer_iframe"}})])],1)},i=[],o=a("5530"),r=a("1da1"),d=(a("a434"),a("159b"),a("b64b"),a("1276"),a("ac1f"),a("b0c0"),a("a34a")),s=a.n(d),c=(a("5319"),a("8bbf")),l=a.n(c),u={fetchPageSettingDataForVersion:function(e){return e.savetype=IDM.setting.pageSchema.saveType,"disk"==IDM.setting.pageSchema.saveType&&e.version?IDM.http.get(IDM.setting.pageSchema.jsonDir.replace(/{projectNo}/g,e.projectNo||IDM.setting.webRoot.projectNo).replace(/{pageid}/g,e.pageid).replace(/{version}/g,e.version)):IDM.http.get(IDM.setting.api.pageSettingDataUrl||IDM.setting.mockurl.pageSettingDataUrl,e)},fetchApplicationInfo:function(e,t){return IDM.http.get(e,t)},fetchUserInfo:function(e,t){return IDM.http.get(e,t)},fetchUserCustomizationInfo:function(e,t){return IDM.http.get(e,t)},fetchThemeInfo:function(e,t){return IDM.http.get(e,t)},getPageInterfaceInfo:function(e,t){return IDM.http.get(e,t)},postPageInterfaceInfo:function(e,t,a){return IDM.http.post(e,t,a)}};l.a.prototype.$previewApi=u,l.a.prototype.$replace=function(e,t){return IDM.express.replace.call(this,e,t)},l.a.prototype.$eval=function(e,t){return IDM.express.eval.call(this,e,t)};var g={props:{},data:function(){return{}},watch:{},methods:{themeInterfaceHandle:function(e,t){var a=this,n=this,i=this.PageSettingData.page.layout.props.compositeAttr,r=i.themeDataFiled,d=i.themeDataFunction,s=e;if(r){var c=r,l={IDM:window.IDM};l[t]=e,c&&(c=t+(c.startsWiths("[")?"":".")+c,s=window.IDM.express.replace.call(this,"@["+c+"]",l))}if(d&&d.length>0){var u=Object(o["a"])(Object(o["a"])({},n.commonParam()),{},{_this:n});u[t]=e,d.forEach((function(e){try{s=window[e.name]&&window[e.name].call(a,Object(o["a"])({customParam:e.param},u))}catch(t){}}))}IDM.theme.setCurrentThemeInfo(s)},setCurrentPageTitle:function(){document.title=this.PageSettingData.pageBaseInfo.title||IDM.setting.applications.defaultTitle},commonCustomEventFunHandle:function(e,t){var a=this,n=this;e=e||this.pagePropData;var i,r=e[t];return r&&r.forEach((function(e){i=window[e.name]&&window[e.name].call(a,Object(o["a"])(Object(o["a"])({},n.commonParam()),{},{customParam:e.param,_this:n}))})),i},commonParam:function(){var e=IDM.url.queryObject(),t={pageId:window.IDM.broadcast&&window.IDM.broadcast.pageModule?window.IDM.broadcast.pageModule.id:"",urlData:JSON.stringify(e)};return t},sendBroadcastMessage:function(e){window.IDM.broadcast&&window.IDM.broadcast.send(e)},deleteLayoutAttachAttr:function(e){var t=this;e instanceof Array||(e=[e]),e.forEach((function(e){delete e.env,delete e.hasLoading,delete e.loaded,delete e.loading,delete e.moduleReload,delete e.mountComplete,delete e.props,delete e.routerId,e.children&&e.children.length>0&&t.deleteLayoutAttachAttr(e.children)}))}},mounted:function(){}},p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"idm_render_engine_page_container",style:{zIndex:e.index},attrs:{id:"router_page_"+e.routerId,"data-pageid":e.pageid}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogVisibleStatus,expression:"dialogVisibleStatus"}],staticClass:"idm_dialog_wrap_preview",attrs:{id:"idm_dialog_wrap_"+e.routerId,hideing:e.dialogIsHideing?"hideing":""}},e._l(e.dialogObjectList,(function(t,n){return a("div",{key:n,staticClass:"idm_dialog_shade_layer",class:"idm_dialog_shade_layer_"+t.packageid,attrs:{"dialog-id":t.packageid},on:{click:e.layerClickHandle}})})),0),a("div",{ref:"idm_page_root",staticClass:"idm_page_root",class:""+e.PageSettingData.id,attrs:{id:"PAGE_"+e.PageSettingData.id+"_"+e.routerId,"idm-com-anchor-id":e.PageSettingData.id}}),a("transition",{attrs:{name:"idm_page_user_defined_topbar"}},[e.pageUserDefinedStatus?a("div",{staticClass:"idm_page_user_defined_topbar"},[a("div",{staticClass:"idm_page_user_defined_logo"},[a("svg",{staticClass:"user-defined-logo-svg",attrs:{t:"1659591467192",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1396",width:"32",height:"32"}},[a("path",{attrs:{d:"M727.008 487.232l194.016-184.32a99.2 99.2 0 0 0 0-140.288l-48.416-48.416a99.2 99.2 0 0 0-138.464-1.76L544.64 292.384l-184.064-196.64-1.504-1.568a64.832 64.832 0 0 0-91.712-0.384L129.184 231.968a64.8 64.8 0 0 0-1.12 90.144l181.344 193.728-171.456 162.88a99.264 99.264 0 0 0-28.256 49.28l-28.992 123.744a65.632 65.632 0 0 0 82.4 77.92l119.296-35.136a99.744 99.744 0 0 0 40.32-23.232l169.056-160.608 203.616 217.536 1.504 1.568a64.832 64.832 0 0 0 91.712 0.384l138.176-138.176a64.8 64.8 0 0 0 1.12-90.144l-200.896-214.624zM319.424 786.176l-90.112-90.112a31.488 31.488 0 0 0-9.792-6.496L667.104 264.352l94.272 94.272c1.408 1.408 3.168 2.08 4.768 3.168L319.424 786.176zM778.208 158.784a35.2 35.2 0 0 1 49.12 0.64l48.416 48.416c13.76 13.76 13.76 36.032-0.64 50.4l-64.448 61.216c-1.28-2.08-2.24-4.288-4.064-6.112l-93.12-93.12 64.736-61.44zM288.512 399.904c8-0.128 16-3.168 22.112-9.28l48-48a31.968 31.968 0 1 0-45.248-45.248l-48 48a31.68 31.68 0 0 0-8.928 20.256L174.816 278.4c-0.512-0.512-0.512-1.024-0.352-1.152L312.64 139.04c0.128-0.128 0.672-0.128 1.248 0.416l184.384 196.992-142.432 135.328-67.328-71.872zM145.024 868.288a1.6 1.6 0 0 1-2.016-1.92l28.992-123.744c0.992-4.16 2.944-7.968 5.312-11.488a31.808 31.808 0 0 0 6.752 10.144l88.288 88.288a35.072 35.072 0 0 1-8 3.552l-119.328 35.168z m598.336 16.672c-0.128 0.128-0.672 0.128-1.248-0.416l-125.6-134.176a31.232 31.232 0 0 0 14.08-7.712l48-48a31.968 31.968 0 1 0-45.248-45.248l-48 48a31.68 31.68 0 0 0-7.296 11.904l-39.904-42.656 142.432-135.328 200.576 214.304c0.48 0.512 0.48 1.024 0.352 1.152l-138.144 138.176z","p-id":"1397"}})]),a("span",{staticStyle:{"margin-left":"10px"}},[e._v("自定义工作台")]),e.pagePropData.switchUserCustomizationCommutant?e._e():a("svg",{staticClass:"fold-svg",style:{transform:"rotate("+(e.openUserCustomizationLeftBar?180:0)+"deg)"},attrs:{t:"1659592354438",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17129",width:"24",height:"24"},on:{click:function(t){e.openUserCustomizationLeftBar=!e.openUserCustomizationLeftBar}}},[a("path",{attrs:{d:"M130.901333 529.493333l149.205334 130.517334a8.533333 8.533333 0 0 0 14.122666-6.4V392.533333a8.533333 8.533333 0 0 0-14.122666-6.4L130.901333 516.608a8.533333 8.533333 0 0 0 0 12.8z","p-id":"17130"}}),a("path",{attrs:{d:"M128 213.333333m42.666667 0l682.666666 0q42.666667 0 42.666667 42.666667l0 0q0 42.666667-42.666667 42.666667l-682.666666 0q-42.666667 0-42.666667-42.666667l0 0q0-42.666667 42.666667-42.666667Z","p-id":"17131"}}),a("path",{attrs:{d:"M128 725.333333m42.666667 0l682.666666 0q42.666667 0 42.666667 42.666667l0 0q0 42.666667-42.666667 42.666667l-682.666666 0q-42.666667 0-42.666667-42.666667l0 0q0-42.666667 42.666667-42.666667Z","p-id":"17132"}}),a("path",{attrs:{d:"M384 469.333333m42.666667 0l426.666666 0q42.666667 0 42.666667 42.666667l0 0q0 42.666667-42.666667 42.666667l-426.666666 0q-42.666667 0-42.666667-42.666667l0 0q0-42.666667 42.666667-42.666667Z","p-id":"17133"}})])]),a("div",{staticClass:"idm_page_user_defined_tip"},[e._v(" "+e._s(e.pagePropData.switchUserCustomizationCommutant?"当前模式只支持组件位置对调，您可以移动组件进行组件换位等操作":"您可以对可调整的卡片组件进行移动、添加、删除等操作")+" ")]),a("div",[a("idm-a-button",{attrs:{loading:e.userDefinedSaveLoading,type:"primary"},on:{click:e.userDefinedSave}},[e._v("保 存")]),a("idm-a-button",{staticStyle:{margin:"auto 10px"},on:{click:e.userDefinedQuit}},[e._v("退出编辑")])],1)]):e._e()]),a("transition",{attrs:{name:"idm_page_user_defined_leftbar"}},[e.pageUserDefinedStatus&&e.openUserCustomizationLeftBar?a("div",{staticClass:"idm_page_user_defined_leftbar"},e._l(e.originalUserCustomizationModuleObject.children,(function(t,n){return a("div",{key:n,staticClass:"idm_page_user_defined_allmodule_item",class:!0!==t.hidden?"hover-show-remove":""},[a("span",{attrs:{title:t.props&&t.props.compositeAttr&&t.props.compositeAttr.title||t.asName}},[e._v(" "+e._s(t.props&&t.props.compositeAttr&&t.props.compositeAttr.title||t.asName)+" ")]),a("div",{staticClass:"idm_page_user_defined_allmodule_item_op",attrs:{title:!0===t.hidden?"添加组件":"移除组件"}},[!0!==t.hidden?a("svg",{staticClass:"user-defined-selected-svg",attrs:{t:"1659636928260",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9243",width:"18",height:"18"}},[a("path",{attrs:{d:"M944.78369497 156.71660696l38.8044445 32.66674931a25.36238224 25.36238224 0 0 1 3.04348577 35.76095873L486.63761776 818.67478965a76.08714794 76.08714794 0 0 1-107.20679132 9.18118218l-2.40942618-2.10507822-2.28261403-2.20652672L58.64741395 508.44212703a25.36238224 25.36238224 0 0 1-0.07608729-35.86240846l35.81168359-35.93849576a25.36238224 25.36238224 0 0 1 35.88777088-0.05072486l296.56233848 295.6239297 482.21497784-572.42897249a25.36238224 25.36238224 0 0 1 35.73559752-3.0688482z","p-id":"9244"}})]):e._e(),!0===t.hidden?a("svg",{staticClass:"user-defined-add-svg",attrs:{t:"1659636887235",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9088",width:"18",height:"18"},on:{click:function(a){return e.addUserDefinedSelect(t)}}},[a("path",{attrs:{d:"M462.80754569 45.96622222m10.35630616 0l77.6722963 0q10.35630617 0 10.35630616 10.35630617l0 911.35494322q0 10.35630617-10.35630616 10.35630617l-77.6722963 0q-10.35630617 0-10.35630616-10.35630617l0-911.35494322q0-10.35630617 10.35630616-10.35630617Z","p-id":"9089"}}),a("path",{attrs:{d:"M66.67883457 462.80754569m10.35630618 0l869.9297185 0q10.35630617 0 10.35630618 10.35630616l0 77.6722963q0 10.35630617-10.35630618 10.35630616l-869.9297185 0q-10.35630617 0-10.35630618-10.35630616l0-77.6722963q0-10.35630617 10.35630618-10.35630616Z","p-id":"9090"}})]):e._e(),!0!==t.hidden?a("svg",{staticClass:"user-defined-remove-svg",attrs:{t:"1659629683475",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9221",width:"18",height:"18"},on:{click:function(a){return e.removeUserDefinedSelect(t)}}},[a("path",{attrs:{d:"M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z","p-id":"9222"}})]):e._e()])])})),0):e._e()]),a("idm-a-modal",{attrs:{title:"组件替换",visible:e.pageUserDefinedModalVisible,footer:null,width:"666px"},on:{cancel:function(t){e.pageUserDefinedModalVisible=!1}}},[a("div",{staticClass:"idm_page_user_defined_modal_alert"},[e._v(" 当前位置已显示 "),a("span",[e._v(e._s(e.currentContainerShowModuleName))]),e._v(" 组件，您可以选择其他组件交换当前组件显示的位置 ")]),e.customModuleObject?a("div",{staticClass:"idm_page_user_defined_modal_modulelist"},e._l(e.customModuleObject.children||[],(function(t,n){return a("div",{key:n,staticClass:"idm_page_user_defined_modal_moduleitem",class:{active:t.packageid==e.currentContainerShowPackageid}},[a("div",{attrs:{title:t.props&&t.props.compositeAttr&&t.props.compositeAttr.title||t.asName}},[a("label",[e._v(e._s(t.props&&t.props.compositeAttr&&t.props.compositeAttr.title||t.asName))]),t.containerIndex<999999999?a("span",[e._v("已显示在序号 "+e._s(t.containerIndex)+" 容器中 ")]):e._e()]),a("div",[t.packageid==e.currentContainerShowPackageid?a("div",{staticClass:"user-defined-modal-selected"},[a("svg",{attrs:{t:"1659636928260",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9243",width:"18",height:"18"}},[a("path",{attrs:{d:"M944.78369497 156.71660696l38.8044445 32.66674931a25.36238224 25.36238224 0 0 1 3.04348577 35.76095873L486.63761776 818.67478965a76.08714794 76.08714794 0 0 1-107.20679132 9.18118218l-2.40942618-2.10507822-2.28261403-2.20652672L58.64741395 508.44212703a25.36238224 25.36238224 0 0 1-0.07608729-35.86240846l35.81168359-35.93849576a25.36238224 25.36238224 0 0 1 35.88777088-0.05072486l296.56233848 295.6239297 482.21497784-572.42897249a25.36238224 25.36238224 0 0 1 35.73559752-3.0688482z","p-id":"9244"}})]),e._v(" 已选 ")]):t.containerIndex<999999999?a("div",{staticClass:"user-defined-modal-changeseats",on:{click:function(a){return e.userDefinedModuleReplace(t,"changeseats")}}},[a("svg",{attrs:{t:"1660186463623",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7012",width:"18",height:"18"}},[a("path",{attrs:{d:"M629.419 104.311c113.459 11.333 204.663 79.736 224.05 196.882h-65.672l106.087 157.832L999.97 301.193h-73.182c-19.524-157.833-138.99-260.37-289.86-274.979-20.89-1.638-40.277 16.248-40.277 39.049 1.365 19.524 14.745 37.41 32.768 39.048z m-164.25-79.735H96.256c-20.89 0-37.274 17.886-37.274 40.687V416.7c0 22.8 16.384 40.687 37.274 40.687h368.913c20.89 0 37.274-17.886 37.274-40.687V65.263c0-22.801-16.384-40.687-37.274-40.687zM429.261 379.29H132.164V102.673h297.233l-0.136 276.617z m-35.908 540.125c-126.976-11.332-224.052-95.982-228.557-235.93h70.178L129.16 525.79 23.074 683.486h70.178c2.867 180.633 129.843 297.78 292.728 314.027 20.89 1.638 40.277-16.248 40.277-39.049 0.41-19.388-13.653-36.045-32.904-39.049z m534.8-353.075H559.242c-21.027 0-37.274 18.023-37.274 40.687v353.075c0 22.665 16.384 40.55 37.274 40.55h368.913c20.89 0 37.273-17.885 37.273-40.55V607.027c0-22.664-17.886-40.687-37.273-40.687z m-35.908 354.714H595.012V646.076h297.233v274.978z m0 0","p-id":"7013"}})]),e._v(" 换位 ")]):a("div",{staticClass:"user-defined-modal-replace",on:{click:function(a){return e.userDefinedModuleReplace(t,"replace")}}},[a("svg",{attrs:{t:"1660186765079",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7166",width:"18",height:"18"}},[a("path",{attrs:{d:"M911.14666667 610.98666667H112.85333333c-23.57333333 0-42.66666667 19.09333333-42.66666666 42.66666666 0 8.96 2.77333333 17.28 7.46666666 24.10666667 2.02666667 4.8 5.12 9.28 8.96 13.22666667L274.66666667 878.93333333c8.32 8.32 19.2 12.48 30.18666666 12.48s21.86666667-4.16 30.18666667-12.48c16.64-16.64 16.64-43.62666667 0-60.37333333L212.58666667 696.32h698.45333333c23.57333333 0 42.66666667-19.09333333 42.66666667-42.66666667s-18.98666667-42.66666667-42.56-42.66666666zM112.85333333 413.01333333h798.29333334c23.57333333 0 42.66666667-19.09333333 42.66666666-42.66666666 0-8.96-2.77333333-17.28-7.46666666-24.10666667-1.49333333-3.52-3.62666667-6.93333333-6.18666667-10.13333333L786.34666667 148.16c-14.93333333-18.24-41.81333333-20.90666667-60.05333334-5.97333333-18.24 14.93333333-20.90666667 41.81333333-5.97333333 60.05333333l102.72 125.44H112.85333333c-23.57333333 0-42.66666667 19.09333333-42.66666666 42.66666667s19.09333333 42.66666667 42.66666666 42.66666666z","p-id":"7167"}})]),e._v(" 替换 ")])])])})),0):e._e()])],1)},h=[],m=a("ade3"),f=(a("a9e3"),a("99af"),a("7db0"),a("a15b"),{mixins:[g],name:"Page",components:{},data:function(){return{PageSettingData:{},dialogVisibleStatus:!1,dialogIsHideing:!1,dialogObjectList:[],drawerVisible:!1,pagePropData:{},pageUserDefinedStatus:!1,userDefinedSaveLoading:!1,openUserCustomizationLeftBar:!1,originalUserCustomizationModuleObject:{children:[]},pageUserDefinedModalVisible:!1,currentContainerShowPackageid:"",currentContainerShowModuleName:"",currentContainerShowModuleObject:{},customModuleObject:null}},props:{pageid:{type:String},routerId:{type:String},devpreview:{type:Boolean},mainPage:{type:Boolean},index:{type:Number}},created:function(){var e=this,t=this;this.devpreview?(this.PageSettingData=JSON.parse(window.localStorage["devpreview"]),IDM.router.pageDataCachePool.put(t.pageid,_.cloneDeep(this.PageSettingData)),this.loadPageElement()):IDM.router.pageDataCachePool.get(this.pageid)?(this.PageSettingData=_.cloneDeep(IDM.router.pageDataCachePool.get(this.pageid)),this.loadPageElement()):this.$previewApi.fetchPageSettingDataForVersion({pageid:this.pageid,version:""}).then((function(a){e.PageSettingData=a.data.data,IDM.router.pageDataCachePool.put(t.pageid,_.cloneDeep(a.data.data)),e.loadPageElement()})).catch((function(e){IDM.message.error("页面配置信息加载失败！message："+e.message)}))},methods:{loadPageElement:function(){var e=this;return Object(r["a"])(s.a.mark((function t(){var a,n,i,o;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(a=!1,n=0;n<e.PageSettingData.page.componentsMap.length;n++)i=e.PageSettingData.page.componentsMap[n],i.packageid==e.PageSettingData.page.layout.packageid&&(e.PageSettingData.page.layout.props=i.props),i.comLangue&&"react"==i.comLangue.toLocaleLowerCase()&&(a=!0);return t.next=4,e.initReactOrOtherLib(a);case 4:return e.PageSettingData.page.actions&&e.PageSettingData.page.actions.compiled&&(o=$('<script type="text/javascript" id="'+e.pageid+'"/>'),$("body").append(o.html("var exports={};"+e.PageSettingData.page.actions.compiled))),e.PageSettingData.page.componentsMap.forEach((function(t){t.env="production",t.routerId=e.routerId,t.pageid=e.pageid})),e.IDM.broadcast.registerModule(e.PageSettingData,e.pageid,e.routerId),e.setCurrentPageTitle(),t.next=10,e.initAppAndUserInfo(e.PageSettingData.page.layout.props);case 10:e.mainPage&&e.$emit("mainPageSettingHandle",e.PageSettingData),e.beforeLoadingFunction(),e.pageAttrPropHandle(e.PageSettingData.page.layout.props),e.$nextTick((function(){this.initModuleTreeToPage(null,!0,this.PageSettingData.page.layout)}));case 14:case"end":return t.stop()}}),t)})))()},silentReLogin:function(e,t){var a=this;return Object(r["a"])(s.a.mark((function t(){var n,i,o;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e&&e.openSessionKeep&&e.silentReLoginUrl)){t.next=8;break}return n=!1,i=IDM.setting.sessionKeep.cacheKeyName,o="",window.localStorage[i]?o=window.localStorage[i]:IDM.getCookie(i)?o=IDM.getCookie(i):IDM.url.queryObject()[i]&&(o=IDM.url.queryObject()[i]),t.next=5,IDM.http.post(e.silentReLoginUrl,Object(m["a"])({},i,o)).then((function(e){var t=e.data;"200"==t.code&&(n=!0)})).catch((function(e){}));case 5:if(!n){t.next=8;break}return t.next=8,a.fetchUserInfo(e,!1,!0,!0);case 8:case"end":return t.stop()}}),t)})))()},fetchUserInfo:function(e,t,a,n){var i=this;return Object(r["a"])(s.a.mark((function r(){var d,c;return s.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return d=!0,c=i,r.next=3,i.$previewApi.fetchUserInfo(e.userInfoUrl,Object(o["a"])({pageid:i.pageid},i.commonParam())).then((function(e){var t=e.data;"200"==t.code&&t.data?t=t.data:"200"!=t.code&&(d=!1),(c.mainPage||n)&&IDM.user.setCurrentUserInfo(t),(c.mainPage||n)&&d&&a&&IDM.broadcast.send({type:"linkageReload",rangeModule:"",message:(new Date).getTime()},c.routerId)})).catch((function(e){d=!1}));case 3:if(!t||d){r.next=6;break}return r.next=6,i.silentReLogin(e,a);case 6:case"end":return r.stop()}}),r)})))()},initAppAndUserInfo:function(e){var t=this;return Object(r["a"])(s.a.mark((function a(){var n,i,r,d,c,l,u,g;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t,i=e.compositeAttr,!(i.openFetchApplicationInfo&&i.applicationInfoUrl&&t.mainPage)){a.next=5;break}return a.next=5,t.$previewApi.fetchApplicationInfo(i.applicationInfoUrl,Object(o["a"])({pageid:t.pageid},t.commonParam())).then((function(e){var t=e.data;"200"==t.code&&t.data&&(t=t.data),IDM.app.setAppInfo(t)})).catch((function(e){}));case 5:if(!i.openFetchUserInfo||!i.userInfoUrl){a.next=8;break}return a.next=8,t.fetchUserInfo(i,!0);case 8:if(r="",i.switchUserInfo&&i.switchUserInfoFiledName?(d=i.switchUserInfoFiledName,c="userObject",l={IDM:window.IDM},l[c]=IDM.user.getCurrentUserInfo(),d&&(d=c+(d.startsWiths("[")?"":".")+d,r=window.IDM.express.replace.call(t,"@["+d+"]",l))):i.switchUserInfo&&(r=IDM.user.getCurrentUserInfo()&&IDM.user.getCurrentUserInfo().data?IDM.user.getCurrentUserInfo().data.userid:""),i.switchUserInfo&&!r&&(i.loginPageUrl?window.location.href=IDM.url.getWebPath(i.loginPageUrl):window.location.href=""),!i.switchUserCustomization||!i.userCustomizationFetchUrl){a.next=16;break}return u=i.userCustomizationModuleContainer&&i.userCustomizationModuleContainer.length>0?i.userCustomizationModuleContainer[0].moduleId:"",n.originalUserCustomizationModuleObject=_.cloneDeep(n.getModuleTree(n.PageSettingData.page.layout,u)),a.next=16,t.$previewApi.fetchUserCustomizationInfo(i.userCustomizationFetchUrl,{pageid:t.pageid,version:t.PageSettingData.pageBaseInfo.version,urlData:JSON.stringify(t.commonParam())}).then((function(e){if(e&&e.data&&e.data.data&&e.data.data.customData){var t=e.data.data.customData instanceof Object?e.data.data.customData:JSON.parse(e.data.data.customData),a=t.children;if(!a||a&&0==a.length)return;var o=n.getModuleTree(n.PageSettingData.page.layout,t.packageid);if(o&&o.children){var r=[],d=[];a.forEach((function(e,t){if(d.push(e.packageid),!i.switchUserCustomizationCommutant){var a=n.getModuleTree(n.originalUserCustomizationModuleObject,e.packageid);a&&(a.hidden=e.hidden)}for(var s=0;s<o.children.length;s++){var c=o.children[s];if(e.packageid==c.packageid&&!0!==e.hidden){c.containerIndex=e.containerIndex,c.relationType=e.relationType,c.relationId=e.relationId,r.push(c);break}}}));for(var s=0;s<o.children.length;s++){var c=o.children[s];-1==d.indexOf(c.packageid)&&r.push(c)}o.children=r}}})).catch((function(e){}));case 16:if(!(n.mainPage&&i.openIdmTheme&&"customInterface"==i.themeFetchType&&i.themeInterfaceUrl)){a.next=21;break}return a.next=19,t.$previewApi.fetchThemeInfo(i.themeInterfaceUrl,Object(o["a"])({pageid:t.pageid},t.commonParam())).then((function(e){n.themeInterfaceHandle(e.data,"resultData")})).catch((function(e){}));case 19:a.next=22;break;case 21:n.mainPage&&i.openIdmTheme&&"customFunction"==i.themeFetchType&&i.themeCustomFunction&&i.themeCustomFunction.length>0&&(g="",i.themeCustomFunction.forEach((function(e){try{g=window[e.name]&&window[e.name].call(t,Object(o["a"])(Object(o["a"])({},t.commonParam()),{},{customParam:e.param,_this:n}))}catch(a){}})),IDM.theme.setCurrentThemeInfo(g));case 22:case"end":return a.stop()}}),a)})))()},pageUserDefinedStatusChangeHandle:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this;this.pageUserDefinedStatus=e;var n=this.PageSettingData.page.layout.props.compositeAttr,i=n.userCustomizationModuleContainer&&n.userCustomizationModuleContainer.length>0?n.userCustomizationModuleContainer[0].moduleId:"";if(i){var o=this.getModuleTree(this.PageSettingData.page.layout.children,i);if(!o)return!1;this.customModuleObject=o;var r,d,s,c,l,u,g=document.querySelector("#router_page_".concat(a.routerId)).querySelector("#".concat(o.packageid)).getBoundingClientRect(),p={},h=n.switchUserCustomizationCommutant;this.openUserCustomizationLeftBar=!h;var m,f="";!this.moduleMoveEvent&&(this.moduleMoveEvent=function(e){e.stopPropagation(),e.preventDefault();e.target.dataset.packageid;var t={};t.x=e.clientX-p.x,t.y=e.clientY-p.y,s.style.left=t.x+"px",s.style.top=t.y+"px";var a=t.x+s.getBoundingClientRect().width/2,n=t.y+s.getBoundingClientRect().height/2,i=t.x,o=t.x+s.getBoundingClientRect().width,c=t.y,v=t.y+s.getBoundingClientRect().height,w=!1;(g.x>o||g.x+g.width<i||g.y>v||g.y+g.height<c)&&(w=!0);var I=[],b=[],D=[];r&&r.forEach((function(e){var t=e.parentElement.getBoundingClientRect(),n=t.y,r=t.y+t.height;(n<=c&&c<=r||r>=v&&n<=v)&&I.push(e.parentElement),n>c&&r<c&&(t.x<i&&t.x+t.width>i||t.x+t.width<o&&t.x+t.width>i||i<t.x&&t.x+t.width>i&&t.x<o)&&b.push(e.parentElement),a>t.x&&a<t.x+t.width&&D.push(e.parentElement)}));var M=[];I.length>0&&I.forEach((function(e){var t=e.getBoundingClientRect();a>t.x&&a<t.x+t.width&&M.push(e)}));var y=999999999;if(M.length>0?M.forEach((function(e){var t=e.getBoundingClientRect(),a=t.y,n=t.y+t.height;c-a<y&&(m=e,y=c-a,f="top"),n-v<y&&(m=e,y=n-v,f="bottom")})):b.length>0?(b.forEach((function(e){var t=e.getBoundingClientRect();n>t.y+t.height&&n-t.y-t.height<y&&(m=e,y=c-t.y-t.height,f="bottom"),n<t.y&&t.y-n<y&&(m=e,y=t.y-v,f="top")})),m||b.forEach((function(e){var t=e.getBoundingClientRect();n<=t.y+t.height&&n>=t.y&&(Math.abs(a-(t.x+t.width/2))<y&&(m=e,y=Math.abs(a-(t.x+t.width/2))),f="bottom")}))):D.length>0&&w&&D.forEach((function(e){var t=e.getBoundingClientRect();c>t.y+t.height&&c-t.y-t.height<y&&(m=e,y=c-t.y-t.height,f="bottom"),v<t.y&&t.y-v<y&&(m=e,y=t.y-v,f="top")})),d.forEach((function(e){var t=e.getBoundingClientRect();a>t.x&&a<t.x+t.width&&n>t.y&&n<t.y+t.height&&(u=e)})),h&&(d.forEach((function(e){IDM.removeClasss(e,"idm_module_user_defined_placeholderstyle")})),u&&IDM.addClasss(u,"idm_module_user_defined_placeholderstyle")),m&&!h){var P=m.parentElement;"top"==f?P.insertBefore(l,m):P.lastChild==m?P.appendChild(l):P.insertBefore(l,m.nextSibling)}else h||0!=u.childElementCount||u.appendChild(l)}),!this.moduleMoveUpEvent&&(this.moduleMoveUpEvent=function(e){if(e.stopPropagation(),e.preventDefault(),document.removeEventListener("mousemove",a.moduleMoveEvent),document.removeEventListener("mouseup",a.moduleMoveUpEvent),h&&u){var t=l,n=l.parentElement;if(u.childNodes)for(var i=_.cloneDeep(u.childElementCount),o=0;o<i;o++){var r=u.childNodes[0];a.changePageSettingModuleSort(r.id,0==o?c.id:t.id,"bottom"),n.insertBefore(r,t.nextSibling),t=r}u.appendChild(c),a.changePageSettingModuleSort(c.id,u.getAttribute("idm-container-index"),"inner")}else l.parentElement.insertBefore(c,l),m?a.changePageSettingModuleSort(c.id,m.id,f):u&&a.changePageSettingModuleSort(c.id,u.getAttribute("idm-container-index"),"inner");l.remove(),s.remove(),d.forEach((function(e){IDM.removeClasss(e,"idm_module_user_defined_placeholderstyle")})),m=null,f="",IDM.broadcast.send({type:"resendAutoLayout",rangeModule:"",message:{}})}),!this.moduleMousedownEvent&&(this.moduleMousedownEvent=function(e){e.stopPropagation(),e.preventDefault();var t=e.target.dataset.packageid;if(t&&(a.isChangeUserDefined=!0,document.addEventListener("mousemove",a.moduleMoveEvent),document.addEventListener("mouseup",a.moduleMoveUpEvent),c=document.querySelector("#router_page_".concat(a.routerId)).querySelector("#".concat(t)),c)){var n=c.getBoundingClientRect();s=document.createElement("div"),s.id="idm_module_user_defined_movebox",s.className="idm_module_user_defined_movebox",s.style.width=n.width+"px",s.style.height=n.height+"px",p.x=e.clientX-n.x,p.y=e.clientY-n.y,s.style.left=e.clientX-p.x+"px",s.style.top=e.clientY-p.y+"px",s.style.position="absolute",l=document.createElement("div"),l.id="idm_module_user_defined_placeholderbox",l.className="idm_module idm_module_user_defined_placeholderbox",l.style.height=n.height+"px",l.dataset.styleHeight=n.height+"px",c.parentElement.insertBefore(l,c),s.appendChild(c),document.body.appendChild(s),r=document.querySelector("#router_page_".concat(a.routerId)).querySelectorAll(".idm_module_user_defined")}}),d=document.querySelector("#router_page_".concat(a.routerId)).querySelectorAll(".drag_container[idm-ctrl-id='"+o.id+"']"),a.registerModuleMouseDownEvent(),t&&!1===this.pageUserDefinedStatus&&this.userDefinedSave()}else IDM.message.info("没有可以自定义的容器组件！")},registerModuleMouseDownEvent:function(e){var t=this,a=this.PageSettingData.page.layout.props.compositeAttr;this.customModuleObject.children&&this.customModuleObject.children.forEach((function(n){if(!e||e===n.packageid){var i=$("#router_page_".concat(t.routerId," #").concat(n.packageid)),o=document.querySelector("#router_page_".concat(t.routerId)).querySelector("#".concat(n.packageid));if(o)if(t.pageUserDefinedStatus){var r=i.find(">div[idm-ctrl='idm_module']").css("marginLeft"),d=i.find(">div[idm-ctrl='idm_module']").css("marginRight"),s=document.createElement("div");s.className="idm_module_user_defined",s.style.marginLeft=r,s.style.marginRight=d,s.dataset.packageid=n.packageid,a.switchUserCustomizationCommutant?(s.innerHTML='\n            <div title="设置要显示的组件">\n            <svg t="1660125485320" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23286" width="16" height="16"><path d="M510.37806 337.803609c-98.010221 0-177.748287 78.842673-177.748287 175.75284 0 96.91426 79.738066 175.763073 177.748287 175.763073 9.537214 0 19.620873-0.978281 31.797194-3.088338 18.196431-3.281743 30.290887-20.538779 26.963095-38.471197-2.924609-15.732309-16.693194-27.152407-32.747845-27.152407-2.071172 0-4.15974 0.196475-6.123464 0.563842-7.937786 1.402953-14.233166 2.056845-19.807115 2.056845-61.159942 0-110.915136-49.201585-110.915136-109.671819 0-60.467163 49.679469-109.661585 110.747313-109.661585 61.116963 0 110.832248 49.194422 110.832248 109.661585 0 5.892197-0.656963 12.0832-2.088568 19.531845-3.327792 17.928325 8.769734 35.189454 26.959002 38.464033 2.006703 0.360204 4.045129 0.546446 6.070252 0.546446 16.204054 0 30.019711-11.43033 32.832779-27.116591 2.13871-11.45182 3.13848-21.435195 3.13848-31.41857 0.042979-46.873564-18.435884-90.990341-52.033074-124.223233C602.407056 356.106464 557.790906 337.803609 510.37806 337.803609zM938.476161 432.79917c-2.185782-11.426237-11.037381-20.499893-22.563902-23.12058-41.909505-9.508561-76.781734-34.929534-98.185206-71.550593-21.334911-36.560684-26.191522-79.099523-13.68979-119.709429 3.52836-11.123338 0.007163-23.235191-8.951883-30.840402-41.860387-35.721573-89.536222-62.938448-141.695163-80.885192-3.152806-1.088798-6.437619-1.639337-9.776667-1.639337-8.256034 0-16.182564 3.431146-21.724791 9.376555-29.236881 31.04404-68.840878 48.140417-111.5107 48.140417-42.673915 0-82.305541-17.125029-111.607914-48.230468-7.877411-8.333806-20.510126-11.512195-31.580253-7.726985-52.483328 18.171871-100.131535 45.416376-141.640927 80.988546-8.815783 7.591909-12.322653 19.620873-8.934486 30.67258 12.586666 40.645722 7.759731 83.180468-13.597693 119.78106-21.306258 36.5965-56.149834 62.006216-98.17395 71.561849-11.540847 2.709715-20.396539 11.812023-22.559808 23.166629-5.228071 27.169803-7.877411 54.346769-7.877411 80.770582 0 26.426883 2.64934 53.603849 7.873318 80.763418 2.174526 11.411911 11.023054 20.488637 22.552645 23.12058 41.913599 9.512654 76.785827 34.922371 98.19237 71.547523 21.349237 36.59343 26.177196 79.128175 13.583366 119.795387-3.363607 10.969842 0.121773 23.013133 8.973372 30.758538 41.84913 35.707246 89.494267 62.920028 141.662417 80.902588 11.466146 3.885494 23.738657 0.549515 31.454386-7.680936 29.29828-31.091112 68.925812-48.216141 111.593588-48.216141s82.302471 17.125029 111.560842 48.183396c5.556553 5.955642 13.494339 9.380648 21.782096 9.380648 3.27765 0 6.537903-0.520863 9.829879-1.599428 52.126194-17.968234 99.774401-45.184085 141.652184-80.912821 8.791224-7.577582 12.308327-19.628036 8.94165-30.758538-12.597923-40.678468-7.745405-83.20605 13.672394-119.773897 21.324678-36.625152 56.192813-62.030775 98.19237-71.547523 11.390421-2.592035 20.23588-11.633968 22.549575-23.106254 5.223978-27.184129 7.870248-54.358025 7.870248-80.770582C946.342316 487.171522 943.697069 459.965903 938.476161 432.79917zM728.572524 789.878798c-26.02677 20.157085-54.736649 36.553521-85.487 48.818869-36.682457-32.144094-83.60207-49.779753-132.792399-49.779753-48.926316 0-95.838765 17.635659-132.767839 49.786916-30.744211-12.262278-59.45716-28.655643-85.491093-48.812729 9.894348-47.441499 1.889023-96.449679-22.763446-138.627291-24.448832-41.966811-63.427588-73.339332-110.186542-88.840374-2.381234-16.343223-3.584642-32.758078-3.584642-48.869011 0-16.043395 1.203408-32.451086 3.584642-48.851615 46.612621-15.389502 85.584214-46.758953 110.186542-88.850607 24.523533-42.024116 32.525788-91.033319 22.74912-138.620128 26.0237-20.149922 54.735625-36.543288 85.494163-48.815799 36.821627 32.201399 83.73817 49.861618 132.778072 49.861618 49.194422 0 96.109941-17.635659 132.792399-49.779753 30.751375 12.269441 59.45716 28.662807 85.48086 48.812729-9.809413 47.63388-1.835811 96.634898 22.667256 138.620128 24.445762 41.966811 63.416332 73.343425 110.182448 88.850607 2.381234 16.386202 3.584642 32.801057 3.584642 48.940642 0.143263 15.443737-1.031493 31.797194-3.499707 48.701189-46.763047 15.504112-85.73771 46.873564-110.186542 88.836281C726.84416 693.189665 718.845998 742.190683 728.572524 789.878798z" p-id="23287"></path></svg>\n            </div>\n            ',s.querySelector("div").addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault();var a=e.currentTarget.parentElement.dataset.packageid;t.pageUserDefinedModalVisible=!0,t.currentContainerShowPackageid=a,t.currentContainerShowModuleObject=t.getModuleTree(t.PageSettingData.page.layout.children,a),t.currentContainerShowModuleName=t.currentContainerShowModuleObject.props&&t.currentContainerShowModuleObject.props.compositeAttr&&t.currentContainerShowModuleObject.props.compositeAttr.title||t.currentContainerShowModuleObject.asName}))):(s.innerHTML='\n            <div title="移除组件">\n            <svg t="1659629683475" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9221" width="16" height="16"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z" p-id="9222"></path></svg>\n            </div>\n            ',s.querySelector("div").addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault();var a=e.currentTarget.parentElement.dataset.packageid;t.customModuleObject.children.forEach((function(e){e.packageid==a&&(e.hidden=!0)}));var n=t.getModuleTree(t.originalUserCustomizationModuleObject,a);n&&(n.hidden=!0),t.$forceUpdate(),document.querySelector("#router_page_".concat(t.routerId)).querySelector("#".concat(a)).remove()}))),o.appendChild(s),o.addEventListener("mousedown",t.moduleMousedownEvent)}else o&&o.querySelector(".idm_module_user_defined").remove(),o&&o.removeEventListener("mousedown",t.moduleMousedownEvent)}}))},changePageSettingModuleSort:function(e,t,a){var n=this.PageSettingData.page.layout.props.compositeAttr,i=n.userCustomizationModuleContainer&&n.userCustomizationModuleContainer.length>0?n.userCustomizationModuleContainer[0].moduleId:"",o=this.getModuleTree(this.PageSettingData.page.layout.children,i);if(!o)return!1;var r=-1,d=-1;o.children&&o.children.forEach((function(n,i){n.packageid==e&&"inner"==a&&(n.containerIndex=t,n.relationType&&n.relationType.startsWiths("inner_")&&(n.relationType="inner_"+t)),n.packageid==e&&(r=i),n.packageid==t&&(d=i)})),d>-1&&r>-1&&"inner"!=a&&(o.children[r].containerIndex=o.children[d].containerIndex,o.children[r].relationType=a,o.children[r].relationId=t,o.children.splice(d+("bottom"==a?1:0),0,o.children[r]),o.children.splice(r+(d<r?1:0),1))},removeUserDefinedSelect:function(e){var t=this;e.hidden=!0;var a=t.getModuleTree(this.PageSettingData.page.layout.children,e.packageid);a&&(a.hidden=!0),t.$forceUpdate(),document.querySelector("#router_page_".concat(t.routerId)).querySelector("#".concat(e.packageid)).remove()},addUserDefinedSelect:function(e){var t=this;e.hidden=!1;var a,n=t.getModuleTree(this.PageSettingData.page.layout.children,e.packageid);if(!n){var i=this.PageSettingData.page.layout.props.compositeAttr,o=i.userCustomizationModuleContainer&&i.userCustomizationModuleContainer.length>0?i.userCustomizationModuleContainer[0].moduleId:"",r=t.getModuleTree(this.PageSettingData.page.layout.children,o);r.children.push(_.cloneDeep(e))}n&&(n.hidden=!1),t.$forceUpdate(),t.moduleReload(e.packageid),t.registerModuleMouseDownEvent(e.packageid),this.customModuleObject.children&&this.customModuleObject.children.forEach((function(e){e.containerIndex==n.containerIndex&&!0!==e.hidden&&(a=e)})),a?t.changePageSettingModuleSort(e.packageid,a.packageid,"bottom"):t.changePageSettingModuleSort(e.packageid,n.containerIndex,"inner")},userDefinedModuleReplace:function(e,t){var a=this,n=a.currentContainerShowModuleObject.containerIndex;a.currentContainerShowModuleObject.containerIndex=e.containerIndex,a.currentContainerShowModuleObject.relationType=e.relationType,a.currentContainerShowModuleObject.relationId=e.relationId,a.changePageSettingModuleSort(e.packageid,n,"inner"),e.relationType="inner_"+n,"changeseats"==t&&document.querySelector("#router_page_".concat(a.routerId)).querySelector("#".concat(e.packageid)).remove(),document.querySelector("#router_page_".concat(a.routerId)).querySelector("#".concat(a.currentContainerShowModuleObject.packageid)).remove(),a.moduleReload(e.packageid),a.registerModuleMouseDownEvent(e.packageid),"changeseats"==t&&(a.moduleReload(a.currentContainerShowModuleObject.packageid),a.registerModuleMouseDownEvent(a.currentContainerShowModuleObject.packageid)),a.pageUserDefinedModalVisible=!1,IDM.broadcast.send({type:"resendAutoLayout",rangeModule:"",message:{}})},userDefinedSave:function(){var e=this;e.userDefinedSaveLoading=!0;var t=this.PageSettingData.page.layout.props.compositeAttr,a=t.userCustomizationModuleContainer&&t.userCustomizationModuleContainer.length>0?t.userCustomizationModuleContainer[0].moduleId:"",n=this.getModuleTree(this.PageSettingData.page.layout.children,a);if(!n)return e.userDefinedSaveLoading=!1,!1;var i=_.cloneDeep(n);this.deleteLayoutAttachAttr(i),t.userCustomizationSaveUrl&&IDM.http.post(t.userCustomizationSaveUrl,{pageid:this.pageid,version:this.PageSettingData.pageBaseInfo.version,customData:JSON.stringify(i)}).then((function(t){t=t?t.data:{},e.userDefinedSaveLoading=!1,"200"===t.code?(IDM.message.success("保存成功！"),IDM.page.changePageUserDefinedStatus({routerId:e.routerId,status:!1})):IDM.message.error("个性化定制保存失败！message："+t.message)})).catch((function(t){IDM.message.error("个性化定制保存失败！message："+t.message),e.userDefinedSaveLoading=!1}))},userDefinedQuit:function(){!0===this.isChangeUserDefined?window.location.reload():IDM.page.changePageUserDefinedStatus({routerId:this.routerId,status:!1})},layerClickHandle:function(e){var t=e.target.getAttribute("dialog-id");t&&window.IdmBuiltin_CloseDialog({routerId:this.routerId,targetModule:[{moduleId:t}]})},initReactOrOtherLib:function(e){return Object(r["a"])(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||IDM.router.getReact()){t.next=4;break}return IDM.router.setReact(),t.next=4,IDM.http.importFiles([IDM.url.getWebPath("~/lib/react.min.js"),IDM.url.getWebPath("~/lib/react-dom.min.js")]).then((function(){})).catch((function(e){}));case 4:case"end":return t.stop()}}),t)})))()},beforeLoadingFunction:function(){var e=this.PageSettingData.page.layout.props.compositeAttr;e.beforeLoadingFunction&&e.beforeLoadingFunction.length>0&&this.commonCustomEventFunHandle(e,"beforeLoadingFunction")},afterLoadingFunction:function(){var e=this.PageSettingData.page.layout.props.compositeAttr;e.afterLoadingFunction&&e.afterLoadingFunction.length>0&&this.commonCustomEventFunHandle(e,"afterLoadingFunction")},requestPageCommonInterfaceData:function(){if(this.IDM.broadcast.pageLoadCompleteAfter(this.routerId),!this.isloadPageCommonInterface){this.isloadPageCommonInterface=!0,this.afterLoadingFunction();var e=(this.PageSettingData.page.layout.props.compositeAttr?this.PageSettingData.page.layout.props.compositeAttr.interfaceList:[])||[];if(0!=e.length){var t=this.pageid,a=[],n=[];this.PageSettingData.page.componentsMap.forEach((function(e){e.packageid!=t&&(a.push(e.packageid),n.push(e.comId))}));var i={idmPageId:t,moduleIds:a.join(","),componentIds:n.join(",")},o=IDM.url.queryObject();Object.keys(o).forEach((function(e){i[e]=o[e]})),this.orderlyRequestInterface(e,0,i)}}},orderlyRequestInterface:function(e,t,a){if(!(e.length<=t)){var n=e[t];t+=1;var i=this;if(n.preAllowFunction&&n.preAllowFunction.length>0)try{var r=Object(o["a"])(Object(o["a"])({},i.commonParam()),n.preAllowFunction[0].param),d=window[n.preAllowFunction[0].name]&&window[n.preAllowFunction[0].name].call(this,r);if(!1===d)return void i.orderlyRequestInterface(e,t,a)}catch(l){}if("post"==n.interfaceMode&&n.interfaceUrl){if(n.formDataFunction&&n.formDataFunction.length>0)try{var s=Object(o["a"])(Object(o["a"])({},i.commonParam()),n.formDataFunction[0].param),c=window[n.formDataFunction[0].name]&&window[n.formDataFunction[0].name].call(this,s);a=Object(o["a"])(Object(o["a"])({},a),c)}catch(l){}this.$previewApi.postPageInterfaceInfo(n.interfaceUrl,a,{headers:n.interfaceContentType?{"Content-Type":n.interfaceContentType||"application/json;charset=UTF-8"}:{}}).then((function(o){i.callbackModuleSetContext(n,o.data),i.orderlyRequestInterface(e,t,a)})).catch((function(n){i.orderlyRequestInterface(e,t,a)}))}else"get"==n.interfaceMode&&n.interfaceUrl?this.$previewApi.getPageInterfaceInfo(n.interfaceUrl,a).then((function(o){i.callbackModuleSetContext(n,o.data),i.orderlyRequestInterface(e,t,a)})).catch((function(n){i.orderlyRequestInterface(e,t,a)})):i.orderlyRequestInterface(e,t,a)}},callbackModuleSetContext:function(e,t){var a=this;if(this.PageSettingData.page.componentsMap.forEach((function(a){a.idmSetContextValue&&a.idmSetContextValue({type:"pageCommonInterface",key:e.resultDataName,data:t})})),e.interfaceRunLaterFunction&&e.interfaceRunLaterFunction.length>0){var n=e.interfaceRunLaterFunction;n.forEach((function(e){try{window[e.name]&&window[e.name].call(a,Object(o["a"])(Object(o["a"])({},a.commonParam()),{},{customParam:e.param,resultData:t,_this:a}))}catch(n){}}))}var i=this.PageSettingData.page.layout.props.compositeAttr||{};this.mainPage&&i.openIdmTheme&&"pageInterfaceResult"==i.themeFetchType&&i.themeDataName&&e.resultDataName==i.themeDataName&&this.themeInterfaceHandle(t,i.themeDataName)},pageAttrPropHandle:function(e){var t=e.compositeAttr;this.pagePropData=t;var a={};for(var n in t.bgSize&&"custom"==t.bgSize?a["background-size"]=(t.bgSizeWidth?t.bgSizeWidth.inputVal+t.bgSizeWidth.selectVal:"auto")+" "+(t.bgSizeHeight?t.bgSizeHeight.inputVal+t.bgSizeHeight.selectVal:"auto"):t.bgSize&&(a["background-size"]=t.bgSize),t.positionX&&t.positionX.inputVal&&(a["background-position-x"]=t.positionX.inputVal+t.positionX.selectVal),t.positionY&&t.positionY.inputVal&&(a["background-position-y"]=t.positionY.inputVal+t.positionY.selectVal),t)if(t.hasOwnProperty.call(t,n)){var i=t[n];if(!i&&!1!==i)continue;switch(n){case"defaultIdmTheme":IDM.theme.setCurrentThemeInfo(i);break;case"width":case"height":a[n]=i;break;case"bgColor":i.hex8&&(a["background-color"]=IDM.hex8ToRgbaString(i.hex8));break;case"box":i.marginTopVal&&(a["margin-top"]="".concat(i.marginTopVal)),i.marginRightVal&&(a["margin-right"]="".concat(i.marginRightVal)),i.marginBottomVal&&(a["margin-bottom"]="".concat(i.marginBottomVal)),i.marginLeftVal&&(a["margin-left"]="".concat(i.marginLeftVal)),i.paddingTopVal&&(a["padding-top"]="".concat(i.paddingTopVal)),i.paddingRightVal&&(a["padding-right"]="".concat(i.paddingRightVal)),i.paddingBottomVal&&(a["padding-bottom"]="".concat(i.paddingBottomVal)),i.paddingLeftVal&&(a["padding-left"]="".concat(i.paddingLeftVal));break;case"bgImgUrl":a["background-image"]="url(".concat(IDM.url.getWebPath(i),")");break;case"icoImgUrl":try{document.head.querySelector("link[rel='icon']").setAttribute("href",IDM.url.getWebPath(i))}catch(r){}var o=document.createElement("link");o.type="image/x-icon",o.rel="shortcut icon",o.href=IDM.url.getWebPath(i),document.getElementsByTagName("head")[0].appendChild(o);break;case"positionX":break;case"positionY":break;case"bgRepeat":a["background-repeat"]=i;break;case"bgAttachment":a["background-attachment"]=i;break;case"border":i.border.top.width>0&&(a["border-top-width"]=i.border.top.width+i.border.top.widthUnit,a["border-top-style"]=i.border.top.style,i.border.top.colors.hex8&&(a["border-top-color"]=IDM.hex8ToRgbaString(i.border.top.colors.hex8))),i.border.right.width>0&&(a["border-right-width"]=i.border.right.width+i.border.right.widthUnit,a["border-right-style"]=i.border.right.style,i.border.right.colors.hex8&&(a["border-right-color"]=IDM.hex8ToRgbaString(i.border.right.colors.hex8))),i.border.bottom.width>0&&(a["border-bottom-width"]=i.border.bottom.width+i.border.bottom.widthUnit,a["border-bottom-style"]=i.border.bottom.style,i.border.bottom.colors.hex8&&(a["border-bottom-color"]=IDM.hex8ToRgbaString(i.border.bottom.colors.hex8))),i.border.left.width>0&&(a["border-left-width"]=i.border.left.width+i.border.left.widthUnit,a["border-left-style"]=i.border.left.style,i.border.left.colors.hex8&&(a["border-left-color"]=IDM.hex8ToRgbaString(i.border.left.colors.hex8))),a["border-top-left-radius"]=i.radius.leftTop.radius+i.radius.leftTop.radiusUnit,a["border-top-right-radius"]=i.radius.rightTop.radius+i.radius.rightTop.radiusUnit,a["border-bottom-left-radius"]=i.radius.leftBottom.radius+i.radius.leftBottom.radiusUnit,a["border-bottom-right-radius"]=i.radius.rightBottom.radius+i.radius.rightBottom.radiusUnit;break;case"font":a["font-family"]=i.fontFamily,i.fontColors.hex8&&(a["color"]=IDM.hex8ToRgbaString(i.fontColors.hex8)),a["font-weight"]=i.fontWeight&&i.fontWeight.split(" ")[0],a["font-style"]=i.fontStyle,a["font-size"]=i.fontSize+i.fontSizeUnit,a["line-height"]=i.fontLineHeight+("-"==i.fontLineHeightUnit?"":i.fontLineHeightUnit),a["text-align"]=i.fontTextAlign,a["text-decoration"]=i.fontDecoration;break;case"layout":i.display&&"flex"==i.display?(a["display"]="flex",i.direction&&(a["flex-direction"]=i.direction),i.direction&&(a["align-items"]=i.align),i.direction&&(a["justify-content"]=i.justify)):i.display&&(a["display"]=i.display,a["width"]="100%");break;case"pageMinWidth":i.inputVal&&i.selectVal&&(a["min-width"]=i.inputVal+i.selectVal);break}}this.$nextTick((function(e){if(t.watermarkType&&"none"!=t.watermarkType){var a=this.$replace(t.watermarkFont,{IDM:IDM}),n=this.$replace(t.watermarkFont1,{IDM:IDM});IDM.watermark.set(this.$refs.idm_page_root,t.watermarkZindex,"font"!=t.watermarkType?t.watermarkImg:a,"image"==t.watermarkType?"":n,{fontColor:t.watermarkColor&&IDM.hex8ToRgbaString(t.watermarkColor.hex8),fontSize:"".concat(t.watermarkFontSize,"px"),width:t.watermarkSize,height:t.watermarkSize,rotate:t.watermarkRotate,imgSize:t.watermarkImgSize,imgLeftSize:t.watermarkImgLeftSize,fontLeftSize:t.watermarkFontLeftSize,opacity:t.watermarkOpacity/100,topSize:t.watermarkTopSize})}else IDM.watermark.close(this.$refs.idm_page_root)})),IDM.setStyleToPageHead("PAGE_"+this.PageSettingData.id+"_"+this.routerId,a),t.resourceList&&t.resourceList.length>0&&t.resourceList.forEach((function(e){"js"==e.resourceType?IDM.module.loadJs(IDM.url.getWebPath(e.resourceUrl),!0,(function(){}),{async:e.async,defer:e.defer}):IDM.module.loadCss(IDM.url.getWebPath(e.resourceUrl),!0,(function(){}))})),this.convertThemeListAttrToStyleObject(t)},convertThemeListAttrToStyleObject:function(e){var t=e.themeList;if(t)for(var a=IDM.setting&&IDM.setting.applications&&IDM.setting.applications.themeNamePrefix?IDM.setting.applications.themeNamePrefix:"idm-theme-",n=0;n<t.length;n++){var i=t[n];if(i.key==IDM.theme.getCurrentThemeInfo()){var r={color:i.mainColor?i.mainColor.hex8+" !important":""},d={"border-color":i.mainColor?i.mainColor.hex8:""},s={"background-color":i.mainColor?i.mainColor.hex8:""},c={color:i.minorColor?i.minorColor.hex8:""},l={"border-color":i.minorColor?i.minorColor.hex8:""},u={"background-color":i.minorColor?i.minorColor.hex8:""};IDM.setStyleToPageHead(".".concat(a+i.key," .idm_module_user_defined"),Object(o["a"])({},d)),IDM.setStyleToPageHead(".".concat(a+i.key," .idm_module_user_defined>div"),Object(o["a"])({},s)),IDM.setStyleToPageHead(".".concat(a+i.key," .user-defined-logo-svg,\n          .").concat(a+i.key," .idm_page_user_defined_leftbar svg.user-defined-add-svg,\n          .").concat(a+i.key," .idm_page_user_defined_modal_moduleitem .user-defined-modal-changeseats,\n          .").concat(a+i.key," .idm_page_user_defined_modal_moduleitem .user-defined-modal-replace"),Object(o["a"])({},r)),IDM.setStyleToPageHead(".".concat(a+i.key," .idm-ant-btn:active,\n          .").concat(a+i.key," .idm-ant-btn.active,\n          .").concat(a+i.key," .idm-ant-btn-dashed:active,\n          .").concat(a+i.key," .idm-ant-btn-dashed.active"),Object(o["a"])(Object(o["a"])({},r),d)),IDM.setStyleToPageHead(".".concat(a+i.key," .idm-ant-btn-primary,\n          .").concat(a+i.key," .idm-ant-btn-primary:hover,\n          .").concat(a+i.key," .idm-ant-btn-primary:focus"),Object(o["a"])(Object(o["a"])({},s),d)),IDM.setStyleToPageHead(".".concat(a+i.key," .idm-ant-btn:hover,\n          .").concat(a+i.key," .idm-ant-btn:focus,\n          .").concat(a+i.key," .idm-ant-btn-dashed:hover,\n          .").concat(a+i.key," .idm-ant-btn-dashed:focus"),Object(o["a"])(Object(o["a"])({},c),l)),IDM.setStyleToPageHead(".".concat(a+i.key," .idm-ant-btn-primary:hover,\n          .").concat(a+i.key," .idm-ant-btn-primary:focus"),Object(o["a"])(Object(o["a"])({color:"#FFFFFF"},u),l))}}},renderDialog:function(e){var t=this.getModuleTree(this.PageSettingData.page.layout.children,e);if(!t)return!1;if("firstrender"==t.renderType||"activerender"==t.renderType){if(t.renderLicence=!0,"firstrender"==t.renderType&&t.loaded)return _.cloneDeep(t);this.IDM.broadcast.pageModuleLoadCompleteBefore(this.routerId),this.resetLayoutInnerModuleLoadedStatus(t),this.initModuleTreeToPage(t)}return _.cloneDeep(t)},setShowDialog:function(e){this.dialogObjectList.push(e),$("#router_page_"+this.routerId+" #"+e.packageid).css("display","flex"),this.dialogVisibleStatus=!0,this.dialogIsHideing=!1},closeThisOpenDialog:function(e){var t=this,a=e.customParam?e.customParam:e,n=[];a.targetModule.forEach((function(a){n.push(a.moduleId),t.dialogObjectList.forEach((function(n,i){n.packageid==a.moduleId&&(n.dialogIsHideing=!0,$("#router_page_"+t.routerId+" .idm_dialog_shade_layer_"+a.moduleId).attr("hideing","hideing"),n.layerOption&&n.layerOption.cancel&&n.layerOption.cancel(n),e.isOkEvent&&n.layerOption&&n.layerOption.yes&&n.layerOption.yes(n))}))})),this.dialogObjectList.length<=n.length&&(this.dialogIsHideing=!0);var i=this;i.sendBroadcastMessage({type:"linkageCloseDialog",message:e,rangeModule:n}),setTimeout((function(){a.targetModule.forEach((function(e){if($("#router_page_"+t.routerId+" #"+e.moduleId).css("display","none"),i.destroyDialog(e.moduleId),1!=i.dialogObjectList.length){var a=-1;i.dialogObjectList.forEach((function(t,n){t.packageid==e.moduleId&&(a=n,t.layerOption&&t.layerOption.end&&t.layerOption.end(t))})),a>-1&&i.dialogObjectList.splice(a,1)}else i.dialogObjectList=[]})),0==i.dialogObjectList.length&&(i.dialogVisibleStatus=!1,i.dialogIsHideing=!1)}),500),e.callback&&e.callback()},destroyDialog:function(e){var t=this.getModuleTree(this.PageSettingData.page.layout.children,e);t&&"activerender"==t.renderType&&$("#router_page_"+this.routerId+" #"+e).remove()},initModuleTreeToPage:function(e,t,a,n){var i,o=this;if(e=e||o.PageSettingData.page.layout.children,e instanceof Array||(e=[e]),e.forEach((function(e){if("dialog"==e.comType&&!0!==e.renderLicence){for(var t=0;t<o.PageSettingData.page.componentsMap.length;t++){var a=o.PageSettingData.page.componentsMap[t];a.packageid==e.packageid&&(e.props=a.props)}var n=e.props.compositeAttr.dialogRenderType;if(e.renderType=n,e.renderLicence=!("firstrender"==n||"activerender"==n),!e.renderLicence)return}e.hasLoading||i||(i=e,e.hasLoading=!0,e.loading=!0)})),i){var r=i;r.mountComplete=this.moduleMountComplete,r.moduleReload=this.moduleReload;var d=o.createModuleDom(r),s="";if("dialog"==r.comType)s=o.PageSettingData.id,$("#idm_dialog_wrap_"+o.routerId).append(d);else if(n)s=n,$("#router_page_"+o.routerId+" #"+s).after(d);else if(t&&a)if(s=a.packageid,s==o.PageSettingData.id)$("#PAGE_"+s+"_"+o.routerId).append(d);else{var c=$("#router_page_"+o.routerId+" #"+s);c.removeClass("drag_container_empty");var l=c.find(">*[idm-ctrl]");if(l.show(),r.containerIndex||"0"==r.containerIndex){var u=l.find(".drag_container[idm-ctrl-id='"+a.id+"'][idm-container-index="+r.containerIndex+"]");u&&u.append(d),u&&u.removeClass("drag_container_empty")}else l.append(d)}r.env="production",r.routerId=this.routerId,r.pageid=this.pageid;for(var g=0;g<o.PageSettingData.page.componentsMap.length;g++){var p=o.PageSettingData.page.componentsMap[g];p.packageid==r.packageid&&(r.props=p.props)}o.IDM.module.addModuleToQueue(r)}else e.forEach((function(e){("dialog"!=e.comType||e.renderLicence)&&e.children&&e.children.length>0&&o.initModuleTreeToPage(e.children,!0,e)}));return i},pageModuleDataIsLoaded:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hasLoading",i=this,o=!0;return e=e||i.PageSettingData.page.layout.children,e instanceof Array||(e=[e]),e.forEach((function(e){("dialog"!=e.comType||e.renderLicence)&&(e[n]||(o=!1))})),o&&e.forEach((function(e){("dialog"!=e.comType||e.renderLicence)&&e.children&&e.children.length>0&&o&&(o=a.pageModuleDataIsLoaded(e.children,t,n))})),o},createModuleDom:function(e){e.packageid=e.packageid||"component_"+IDM.UUID(),e.id=e.id||e.packageid+"_inner";var t=$("<div />");return t.attr("id",e.packageid),t.attr("idm-com-anchor-id",e.packageid),t.attr("idm-com-id",e.comId),t.attr("idm-com-classid",e.classId),t.attr("idm-com-classname",e.className),t.addClass("idm_module"),t.addClass(e.packageid),t.append($("<div />").attr("id","idm_"+e.id+this.routerId)),t},getModuleTree:function(e,t){var a,n=this;return e instanceof Array||(e=[e]),e.forEach((function(e){e.packageid==t?a=e:!a&&e.children&&(a=n.getModuleTree(e.children,t))})),a},moduleReload:function(e,t){var a,n=this,i=this.getModuleTree(this.PageSettingData.page.layout.children,e),o=[i];if(t||"0"==t)o=[],i&&i.children&&i.children.forEach((function(e){e.containerIndex==t&&o.push(e)})),a=i;else{var r=i.globalId.split("."),d=r.length<=2?r[0]:r[r.length-2];a=this.getModuleTree(this.PageSettingData.page.layout.children,d)}this.resetLayoutInnerModuleLoadedStatus(o),o&&o.forEach((function(e){$("#router_page_"+n.routerId+" #"+e.packageid).remove()})),this.initModuleTreeToPage(o,!0,a,!1)},moduleMountComplete:function(e){var t=this;this.PageSettingData.page.componentsMap.forEach((function(t){t.packageid==e.packageid&&(t.idmBroadcastMessage=e.idmBroadcastMessage,t.idmSetContextValue=e.idmSetContextValue,t.idmGetContextValue=e.idmGetContextValue)}));var a=this.getModuleTree(this.PageSettingData.page.layout.children,e.packageid);if(a.loading=!1,a.loaded=!0,a.children&&a.children.length>0){var n=$("#"+e.packageid);if(0==n.find(":visible").length)var i=0,o=setInterval((function(){i++,0==$("#router_page_"+t.routerId+" #"+e.packageid).find(":visible").length&&i<=20||(clearInterval(o),t.moduleMountCompleteCommon(e))}),5);else setTimeout((function(){t.moduleMountCompleteCommon(e)}),3)}else setTimeout((function(){t.moduleMountCompleteCommon(e)}),3)},moduleMountCompleteCommon:function(e){var t=$("#router_page_"+this.routerId+" #"+e.packageid),a=t.find(">*[idm-ctrl]"),n=a.attr("idm-ctrl"),i=a.attr("idm-ctrl-id"),o=a.attr("id");switch(o||a.attr("id",i),n){case"drag_container":t.addClass("drag_container");break;case"drag_container_inlineblock":t.addClass("drag_container drag_container_inlineblock");break;case"idm_module":break}this.pageModuleDataIsLoaded(null,!0)?this.pageModuleDataIsLoaded(null,!0,"loaded")&&this.requestPageCommonInterfaceData():this.$nextTick((function(){this.initModuleTreeToPage(null,!0,this.PageSettingData.page.layout)}))},initModuleInnerEventHandle:function(e){var t=this,a=$("#router_page_"+t.routerId+" #"+e.packageid),n=a.find(".drag_container[idm-ctrl-id='"+e.id+"'][idm-ctrl-inner]");if(n.length>0){var i=this.getModuleTree(this.PageSettingData.page.layout.children,e.packageid);this.resetLayoutInnerModuleLoadedStatus(i.children),i.children&&i.children.length>0&&(i.children.forEach((function(e){$("#"+e.packageid).remove()})),this.initModuleTreeToPage(i.children,!0,i))}},resetLayoutInnerModuleLoadedStatus:function(e){var t=this;e instanceof Array||(e=[e]),e.forEach((function(e){delete e.loaded,delete e.loading,delete e.hasLoading,e.children&&e.children.length>0&&t.resetLayoutInnerModuleLoadedStatus(e.children)}))}}}),v=f,w=a("2877"),I=Object(w["a"])(v,p,h,!1,null,null,null),b=I.exports,D={mixins:[g],name:"Preview",components:{Page:b},data:function(){return{pageid:"",PageSettingData:{},dialogVisibleStatus:!1,dialogIsHideing:!1,dialogObjectList:[],drawerVisible:!1,drawerIframeUrl:"",drawerControlSetPanelOption:null,pagePropData:{},AppPageList:[],currentTransitionType:1}},mounted:function(){this.windowResizeEvent((function(){IDM.broadcast.send({type:"pageResize",rangeModule:"",message:IDM.getClientWH()})}))},created:function(){IDM.router.pageDataCachePool=IDM.cachePool(100),this.initCommonRequireJsCss(),this.pageid=this.$route.params.pageid,this.AppPageList.push({routerId:"",pageid:this.pageid,devpreview:"devpreview"==this.pageid,mainPage:!0,keep:!0}),this.injectInnerActionToWindow()},methods:{windowResizeEvent:function(e){window.onresize=function(){var t=this;t.resizeFlag&&clearTimeout(t.resizeFlag),t.resizeFlag=setTimeout((function(){e(),t.resizeFlag=null}),100)}},mainPageSettingHandle:function(e){var t=this;return Object(r["a"])(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.PageSettingData=e,a.next=3,t.loadPageElement();case 3:case"end":return a.stop()}}),a)})))()},drawerOnClose:function(){this.drawerVisible=!1,this.commonCustomEventFunHandle(null,"drawerCloseFunction")},drawerOnAfterVisibleChange:function(){this.commonCustomEventFunHandle(null,"drawerAfterVisibleChangeFunction")},injectInnerActionToWindow:function(){window.IdmBuiltin_OpenControlSetPanel=this.IdmBuiltin_OpenControlSetPanel,window.IdmBuiltin_CloseControlSetPanel=this.IdmBuiltin_CloseControlSetPanel,window.IdmBuiltin_OpenUrl=this.IdmBuiltin_OpenUrl,window.IdmBuiltin_OpenDialog=this.IdmBuiltin_OpenDialog,window.IdmBuiltin_CloseDialog=this.IdmBuiltin_CloseDialog,window.IdmBuiltin_ShowModule=this.IdmBuiltin_ShowModule,window.IdmBuiltin_HideModule=this.IdmBuiltin_HideModule,window.IdmBuiltin_InitNewPage=this.IdmBuiltin_InitNewPage,window.IdmBuiltin_backPage=this.IdmBuiltin_backPage,window.IdmBuiltin_changePageUserDefinedStatus=this.IdmBuiltin_changePageUserDefinedStatus},IdmBuiltin_changePageUserDefinedStatus:function(e){for(var t=e.routerId||"",a=0;a<this.AppPageList.length;a++){var n=this.AppPageList[a];if(t==n.routerId){var i=this.$refs["idm_page_"+n.routerId];i instanceof Array&&(i=i[0]),i.pageUserDefinedStatusChangeHandle(e.status,e.save)}}},transitionAfterEnter:function(){},IdmBuiltin_InitNewPage:function(e){var t=this;this.AppPageList.push({routerId:e.routerId,pageid:e.next,devpreview:"devpreview"==e.next,mainPage:!1,keep:!0,scrollTop:$(window).scrollTop()});var a=!1;if(e.meta&&!1===e.meta.keep)this.AppPageList[this.AppPageList.length-2].keep=!1,a=!0;else if(e.meta&&"memory"===e.meta.keep){this.AppPageList[this.AppPageList.length-2].routerId;a=!0}$(window).scrollTop(0),a&&this.$nextTick((function(){var a=IDM.router.pageDataCachePool.get(e.from);if(a){for(var n=null,i=0;i<a.page.componentsMap.length;i++){var o=a.page.componentsMap[i];if(o.packageid==a.page.layout.packageid){n=o.props.compositeAttr;break}}IDM.router.commonCustomEventFunHandle(n,"pageNoKeepDestroyedFunction",e,t.AppPageList[t.AppPageList.length-2].pageid)}}))},IdmBuiltin_backPage:function(e,t){for(var a=null,n=0;n<this.AppPageList.length;n++){var i=this.AppPageList[n];i.routerId==e.routerId&&this.AppPageList.splice(n,1),e&&!1===e.meta.keep&&(t&&t.routerId==i.routerId||!t&&i.mainPage)&&(i.keep=!0),(t&&t.routerId==i.routerId||!t&&i.mainPage)&&(a=i,$(window).scrollTop(i.scrollTop))}this.$nextTick((function(){var n=IDM.router.pageDataCachePool.get(e.next),i=null;if(n){for(var o=0;o<n.page.componentsMap.length;o++){var r=n.page.componentsMap[o];if(r.packageid==n.page.layout.packageid){i=r.props.compositeAttr;break}}IDM.router.commonCustomEventFunHandle(i,"pageBackDestroyedFunction",e,e.next)}if(IDM.broadcast.unRegisterModule(e.routerId),n=IDM.router.pageDataCachePool.get(a.pageid),n){for(var d=0;d<n.page.componentsMap.length;d++){var s=n.page.componentsMap[d];if(s.packageid==n.page.layout.packageid){i=s.props.compositeAttr;break}}IDM.router.commonCustomEventFunHandle(i,"pageActivatedFunction",t,a.pageid)}}))},IdmBuiltin_OpenControlSetPanel:function(e){var t=this.pagePropData.moduleControlCenterSettingUrl;if(t){if(t+=-1==t.indexOf("?")?"?":"&",e&&e.controlSetPanelOption){if(!(e.controlSetPanelOption.param&&e.controlSetPanelOption.param.marketModuleId&&e.controlSetPanelOption.param.pageId&&e.controlSetPanelOption.param.packageid))return;Object.keys(e.controlSetPanelOption.param).forEach((function(a,n){n>0&&(t+="&"),t=t+a+"="+e.controlSetPanelOption.param[a]}))}this.drawerIframeUrl=IDM.url.getWebPath(t),this.drawerControlSetPanelOption=e.controlSetPanelOption||null,this.drawerVisible=!0,this.drawerControlSetPanelOption&&this.drawerControlSetPanelOption.success&&this.drawerControlSetPanelOption.success(e.controlSetPanelOption.controlSetPanelId)}},IdmBuiltin_CloseControlSetPanel:function(e){if(e&&e.innerClose||e&&e.controlSetPanelOption&&e.controlSetPanelOption.controlSetPanelId&&this.drawerControlSetPanelOption&&e.controlSetPanelOption.controlSetPanelId==this.drawerControlSetPanelOption.controlSetPanelId)switch(this.drawerOnClose(),e.actionType){case"close":case"other":this.drawerControlSetPanelOption&&this.drawerControlSetPanelOption.other&&this.drawerControlSetPanelOption.other();break;case"commit":this.drawerControlSetPanelOption&&this.drawerControlSetPanelOption.yes&&this.drawerControlSetPanelOption.yes();break;case"reset":this.drawerControlSetPanelOption&&this.drawerControlSetPanelOption.reset&&this.drawerControlSetPanelOption.reset();break}},IdmBuiltin_OpenUrl:function(e){var t=e.customParam?e.customParam:e;window.open(IDM.url.getWebPath(t.openUrl),t.openName,t.openFeatures)},IdmBuiltin_OpenDialog:function(e){var t=this,a=e.customParam?e.customParam:e,n=e.routerId||"",i=[],o=0,r=[];if(a.targetModule.forEach((function(a){i.push(a.moduleId);for(var d=0;d<t.AppPageList.length;d++){var s=t.AppPageList[d];if(n==s.routerId){var c=t.$refs["idm_page_"+s.routerId];c instanceof Array&&(c=c[0]);var l=c.renderDialog(a.moduleId);!1!==l&&(r.push(c),l.dialogIsHideing=!1,e.layerOption&&(l.layerOption=e.layerOption),t.dialogObjectList.push(l),o++,c.setShowDialog(l))}}})),0!=o){var d=this;this.$nextTick((function(){setTimeout((function(){d.sendBroadcastMessage({type:"linkageOpenDialog",message:e,rangeModule:i})}),5)})),e.callback&&e.callback()}},IdmBuiltin_CloseDialog:function(e){for(var t=e.routerId||"",a=0;a<this.AppPageList.length;a++){var n=this.AppPageList[a];if(t==n.routerId){var i=this.$refs["idm_page_"+n.routerId];i instanceof Array&&(i=i[0]),i.closeThisOpenDialog(e)}}},IdmBuiltin_ShowModule:function(e){var t=e.customParam?e.customParam:e,a=e.routerId||"",n=[];t.targetModule.forEach((function(e){n.push(e.moduleId),$((a?"#router_page_"+a+" ":"")+"#"+e.moduleId).show()})),this.sendBroadcastMessage({type:"linkageShowModule",message:e,rangeModule:n}),e.callback&&e.callback()},IdmBuiltin_HideModule:function(e){var t=e.customParam?e.customParam:e,a=e.routerId||"",n=[];t.targetModule.forEach((function(e){n.push(e.moduleId),$((a?"#router_page_"+a+" ":"")+"#"+e.moduleId).hide()})),this.sendBroadcastMessage({type:"linkageHideModule",message:e,rangeModule:n}),e.callback&&e.callback()},weixinEventHandle:function(e){var t=this,a=this,n=e.compositeAttr;if(n.switchWeixinJSSDK){var i=IDM.setting.weixin.requireJsCss;if(i&&"string"==IDM.type(i)&&(i=[i]),i&&IDM.setting.weixin.signatureUrl){var r=[];i.forEach((function(e){return r.push(IDM.url.getWebPath(e))})),IDM.http.importFiles(r).then((function(){IDM.http.get(IDM.setting.weixin.signatureUrl,{url:window.location.href.split("#")[0]}).then((function(e){var i=e.data;"200"==i.code&&i.data&&(i=i.data),wx.config({beta:!0,debug:!0===IDM.setting.weixin.debug,appId:i.appId,timestamp:i.timestamp,nonceStr:i.nonceStr,signature:i.signature,jsApiList:IDM.setting.weixin.jsApiList}),wx.ready((function(){var e=n.weixinReadyFunction;e&&e.forEach((function(e){try{window[e.name]&&window[e.name].call(t,Object(o["a"])(Object(o["a"])({},a.commonParam()),{},{customParam:e.param,_this:t}))}catch(n){}}))})),wx.error((function(e){var i=n.weixinErrorFunction;i&&i.forEach((function(n){try{window[n.name]&&window[n.name].call(t,Object(o["a"])(Object(o["a"])({},a.commonParam()),{},{customParam:n.param,_this:t,error:e}))}catch(i){}}))}))})).catch((function(e){}))})).catch((function(e){}))}}},webSocketEventHandle:function(e){var t=this,a=e.compositeAttr;a.switchWebSocket&&(a.websocketInitName&&"function"==typeof window[a.websocketInitName]&&window[a.websocketInitName](),a.websocketOpenEvent&&(window[a.websocketOpenEvent]=function(){var e=this,n=a.websocketOpenFunction;n&&n.forEach((function(a){try{window[a.name]&&window[a.name].call(e,Object(o["a"])(Object(o["a"])({},t.commonParam()),{},{customParam:a.param,_this:e}))}catch(n){}}))}),a.websocketMessageEvent&&(window[a.websocketMessageEvent]=function(e){var n=this;IDM.broadcast.send({type:"websocket",rangeModule:"",globalSend:!0,message:e});var i=a.websocketMessageFunction;i&&i.forEach((function(a){try{window[a.name]&&window[a.name].call(n,Object(o["a"])(Object(o["a"])({},t.commonParam()),{},{customParam:a.param,msgData:e,_this:n}))}catch(i){}}))}))},initCommonRequireJsCss:function(){if(IDM.setting.applications.commonRequireJsCss&&IDM.setting.applications.commonRequireJsCss instanceof Array){var e=[];IDM.setting.applications.commonRequireJsCss.forEach((function(t){return e.push(IDM.url.getWebPath(t))}));try{IDM.http.importFiles(e).then((function(){})).catch((function(e){}))}catch(t){}}},initPulltorefreshPlugin:function(){var e=this,t=this.PageSettingData.page.layout.props.compositeAttr;t.openPulltorefresh?IDM.http.importFiles([IDM.url.getWebPath("~/lib/pulltorefreshjs/index.umd.min.js")]).then((function(){var t=PullToRefresh.init({mainElement:"body",instructionsPullToRefresh:"下拉刷新",instructionsReleaseToRefresh:"松手刷新",instructionsRefreshing:"刷新中",onRefresh:function(){e.initPulltorefreshHandle()},shouldPullToRefresh:function(){return IDM.page.getPullToRefreshStatus()&&!$(window).scrollTop()}});IDM.page.startPullToRefresh(t)})).catch((function(e){})):IDM.page.stopPullToRefresh()},initPulltorefreshHandle:function(){var e=this,t=this.AppPageList[this.AppPageList.length-1].pageid,a=this.AppPageList[this.AppPageList.length-1].routerId,n=IDM.router.pageDataCachePool.get(t)||this.PageSettingData,i=n.page.layout.props.compositeAttr;switch(i.pulltorefreshType){case"page":window.location.reload();break;case"data":try{var o=this.$refs["idm_page_"+a];o instanceof Array&&(o=o[0]),o.fetchUserInfo(i,!0,!0,!0)}catch(d){}break;case"custom":var r=i.pulltorefreshFunction;r&&r.forEach((function(t){window[t.name]&&window[t.name].call(e,{customParam:t.param})}));break}},initVconsolePlugin:function(){var e=this.PageSettingData.page.layout.props.compositeAttr,t=e.showVconsole;t&&IDM.http.importFiles([IDM.url.getWebPath("~/lib/vconsole/vconsole.min.js")]).then((function(){new window.VConsole})).catch((function(e){}))},initLoadbarResource:function(){var e=this.PageSettingData.page.layout.props.compositeAttr;if(e.openPreviewLoadStyle){var t=e.previewLoadColor;t&&t.hex8&&document.documentElement.style.setProperty("--idmPreviewLoadColor",IDM.hex8ToRgbaString(t.hex8)),IDM.http.importFiles([IDM.url.getWebPath("~/lib/pace/pace.min.js"),IDM.url.getWebPath("~/lib/pace/minimal.css")]).then((function(){idmPace.stop(),Pace.start()})).catch((function(e){}))}else idmPace.stop()},loadPageElement:function(){var e=this;return Object(r["a"])(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.pagePropData=e.PageSettingData.page.layout.props.compositeAttr,e.initLoadbarResource(),e.initVconsolePlugin(),e.webSocketEventHandle(e.PageSettingData.page.layout.props),e.weixinEventHandle(e.PageSettingData.page.layout.props),e.initPulltorefreshPlugin();case 6:case"end":return t.stop()}}),t)})))()}},watch:{$route:function(e,t){IDM.router.idmInnerRouterEvent?IDM.router.idmInnerRouterEvent=!1:IDM.router.innerRouterChangeEvent(e,t)}}},M=D,y=(a("a081"),Object(w["a"])(M,n,i,!1,null,null,null));t["default"]=y.exports},a081:function(e,t,a){"use strict";a("c29e")},a34a:function(e,t,a){e.exports=a("96cf")},c29e:function(e,t,a){}}]);
//# sourceMappingURL=preview.621bb619.js.map